<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sine Wave Generator with Smooth Buffer Switching</title>
</head>
<body>
    <button id="playButton">Play Sine Wave</button>

    <script>
        // Constants
        const SAMPLE_RATE = 44100; // Sample rate in Hz
        const FREQUENCY = 400; // Frequency of the sine wave in Hz
        const BUFFER_SIZE = 1024; // Buffer size in samples

        // Create an AudioContext
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();

        // ScriptProcessorNode for real-time audio processing
        const scriptProcessor = audioContext.createScriptProcessor(BUFFER_SIZE, 1, 1);
        scriptProcessor.connect(audioContext.destination);

        // Variables for sine wave generation
        let phase = 0;

        // Generate sine wave data
        scriptProcessor.onaudioprocess = (audioProcessingEvent) => {
            const outputBuffer = audioProcessingEvent.outputBuffer.getChannelData(0);

            for (let i = 0; i < BUFFER_SIZE; i++) {
                outputBuffer[i] = Math.sin(phase);
                phase += (2 * Math.PI * FREQUENCY) / SAMPLE_RATE;
                if (phase >= 2 * Math.PI) {
                    phase -= 2 * Math.PI;
                }
            }
        };

        // Handle button click
        document.getElementById('playButton').addEventListener('click', () => {
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }
        });
    </script>
</body>
</html>